#include "CubePrimitive.h"

RENDERER_NAMESPACE_BEGIN

CubePrimitive::CubePrimitive(float size, bool colored) {
    generateCube(size, colored);
}

void CubePrimitive::generateCube(float size, bool colored) {
    float s = size * 0.5f;
    
    std::vector<Vertex> vertices = {
        // 前面 (z = -s)
        {{-s, -s, -s}, {1.0f, 0.0f, 0.0f}, {0.0f, 0.0f, -1.0f}, {0.0f, 0.0f}},
        {{ s, -s, -s}, {0.0f, 1.0f, 0.0f}, {0.0f, 0.0f, -1.0f}, {1.0f, 0.0f}},
        {{ s,  s, -s}, {0.0f, 0.0f, 1.0f}, {0.0f, 0.0f, -1.0f}, {1.0f, 1.0f}},
        {{-s,  s, -s}, {1.0f, 1.0f, 0.0f}, {0.0f, 0.0f, -1.0f}, {0.0f, 1.0f}},
        
        // 后面 (z = s)
        {{-s, -s,  s}, {1.0f, 0.0f, 1.0f}, {0.0f, 0.0f, 1.0f}, {0.0f, 0.0f}},
        {{ s, -s,  s}, {0.0f, 1.0f, 1.0f}, {0.0f, 0.0f, 1.0f}, {1.0f, 0.0f}},
        {{ s,  s,  s}, {1.0f, 1.0f, 1.0f}, {0.0f, 0.0f, 1.0f}, {1.0f, 1.0f}},
        {{-s,  s,  s}, {0.5f, 0.5f, 0.5f}, {0.0f, 0.0f, 1.0f}, {0.0f, 1.0f}},
        
        // 左面 (x = -s)
        {{-s, -s, -s}, {1.0f, 0.0f, 0.0f}, {-1.0f, 0.0f, 0.0f}, {0.0f, 0.0f}},
        {{-s,  s, -s}, {0.0f, 1.0f, 0.0f}, {-1.0f, 0.0f, 0.0f}, {1.0f, 0.0f}},
        {{-s,  s,  s}, {0.0f, 0.0f, 1.0f}, {-1.0f, 0.0f, 0.0f}, {1.0f, 1.0f}},
        {{-s, -s,  s}, {1.0f, 1.0f, 0.0f}, {-1.0f, 0.0f, 0.0f}, {0.0f, 1.0f}},
        
        // 右面 (x = s)
        {{ s, -s, -s}, {1.0f, 0.0f, 1.0f}, {1.0f, 0.0f, 0.0f}, {0.0f, 0.0f}},
        {{ s,  s, -s}, {0.0f, 1.0f, 1.0f}, {1.0f, 0.0f, 0.0f}, {1.0f, 0.0f}},
        {{ s,  s,  s}, {1.0f, 1.0f, 1.0f}, {1.0f, 0.0f, 0.0f}, {1.0f, 1.0f}},
        {{ s, -s,  s}, {0.5f, 0.5f, 0.5f}, {1.0f, 0.0f, 0.0f}, {0.0f, 1.0f}},
        
        // 底面 (y = -s)
        {{-s, -s, -s}, {1.0f, 0.0f, 0.0f}, {0.0f, -1.0f, 0.0f}, {0.0f, 0.0f}},
        {{ s, -s, -s}, {0.0f, 1.0f, 0.0f}, {0.0f, -1.0f, 0.0f}, {1.0f, 0.0f}},
        {{ s, -s,  s}, {0.0f, 0.0f, 1.0f}, {0.0f, -1.0f, 0.0f}, {1.0f, 1.0f}},
        {{-s, -s,  s}, {1.0f, 1.0f, 0.0f}, {0.0f, -1.0f, 0.0f}, {0.0f, 1.0f}},
        
        // 顶面 (y = s)
        {{-s,  s, -s}, {1.0f, 0.0f, 1.0f}, {0.0f, 1.0f, 0.0f}, {0.0f, 0.0f}},
        {{ s,  s, -s}, {0.0f, 1.0f, 1.0f}, {0.0f, 1.0f, 0.0f}, {1.0f, 0.0f}},
        {{ s,  s,  s}, {1.0f, 1.0f, 1.0f}, {0.0f, 1.0f, 0.0f}, {1.0f, 1.0f}},
        {{-s,  s,  s}, {0.5f, 0.5f, 0.5f}, {0.0f, 1.0f, 0.0f}, {0.0f, 1.0f}},
    };
    
    // 如果不需要彩色，统一设置为白色
    if (!colored) {
        for (auto& v : vertices) {
            v.color[0] = v.color[1] = v.color[2] = 1.0f;
        }
    }
    
    std::vector<unsigned int> indices = {
        0,  1,  2,  2,  3,  0,   // 前面
        4,  5,  6,  6,  7,  4,   // 后面
        8,  9,  10, 10, 11, 8,   // 左面
        12, 13, 14, 14, 15, 12,  // 右面
        16, 17, 18, 18, 19, 16,  // 底面
        20, 21, 22, 22, 23, 20   // 顶面
    };
    
    setupBuffers(vertices, indices);
}

RENDERER_NAMESPACE_END